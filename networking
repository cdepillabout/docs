
############ IPTABLES ###############

# accept traffic that _I_ initiated
iptables -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT

# accept traffic from localhost
iptables -A INPUT -s localhost -j ACCEPT


#
# this is to limit connections to sshd
# http://www.debian-administration.org/articles/187
#

# sets a list with the ip of new connections to port 50084
iptables -A INPUT -p tcp --dport 50084 -m state --state NEW -m recent --set

# updates that list of connections if they have had
# more than 4 hits in 60 seconds.  if so, drop.
iptables -A INPUT -p tcp --dport 50084 -m state --state NEW -m recent --update --seconds 60 --hitcount 4 -j DROP

# opens this port for connections that have not been dropped
iptables -A INPUT -p tcp --dport 50084 -j ACCEPT





# open a specific port
iptables -A INPUT -p tcp -i eth0 --dport 80 -j ACCEPT

# this might be better because it puts it before the DROP rule
#iptables -I INPUT 2 -p tcp -i eth0 --dport 80 -j ACCEPT

# make the policy for incomming traffic to DROP
iptables -P INPUT DROP



############## ROUTE COMMANDS #################3

# add a default gateway to the intarweb
route add default gw 192.168.1.1

# an alternative way
route add -net 0.0.0.0/0 gw 192.168.1.1


# this is the command run when an interface is brought up with
# the command `ifconfig eth0 192.168.1.104`
route add -net 192.168.1.0/24 dev eth0`


# delete the route created for you when you bring up an if_interface 
# with the command `ifconfig eth0 192.168.1.104`
# (the /24 is important)
route del -net 192.168.1.0/24 dev eth0



############### TCPDUMP ###############

# don't convert addresses to names
tcpdump -n

# cature on eth0
tcpdump -i eht0

# capture all packets that are not arp and not coming from or
# going to port 22
tcpdump -i eth0 -n -v 'not port 22 and not arp'


############### DIG ###################

# get a trace of all dns servers contacted when looking up
# an address or reversing an address.
dig -x 192.168.1.1 +trace

# get all records associated with an address
dig any example.com


############### OTHER #################

# connect to schools private internet using vpnc
# with a virtual private network
vpnc

# disconnect
vpnc-disconnect


